<!DOCTYPE html>
<!--
 Licensed to the Apache Software Foundation (ASF) under one
 or more contributor license agreements.  See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership.  The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License.  You may obtain a copy of the License at
 
 http://www.apache.org/licenses/LICENSE-2.0
 
 Unless required by applicable law or agreed to in writing,
 software distributed under the License is distributed on an
 "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 KIND, either express or implied.  See the License for the
 specific language governing permissions and limitations
 under the License.
 -->
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <title>Scenic Landscape Puzzles</title>
		<script>
			
			var strPuzzleImageSrc = "";
			var intZIndex = 100;
			var strDevice = "";
			var strDeviceName = "";
			
			function funDevicePrep(){
				intDeviceWidth = parseInt(document.getElementById("body_all").offsetWidth);
				intDeviceHeight = parseInt(document.getElementById("body_all").offsetHeight);
				if(intDeviceWidth == 1024){
					strDevice = "ipad";
					strDeviceName = "iPad";
				}else if(intDeviceWidth == 568){
					strDevice = "iphone5";
					strDeviceName = "iPhone";
				}else{
					strDevice = "iphone";
					strDeviceName = "iPhone";
				}
				document.getElementById("body_all").className = "body_" + strDevice;
			}
			
			function funShowItem(inc_element_id){
				document.getElementById(inc_element_id).style.visibility = "visible";
				document.getElementById(inc_element_id).style.display = "block";
			}
			
			function funHideItem(inc_element_id){
				document.getElementById(inc_element_id).style.visibility = "hidden";
				document.getElementById(inc_element_id).style.display = "none";
			}
			
			function funWidthOffset(inc_element_id){
                return document.getElementById(inc_element_id).offsetWidth / 2;
            }
            
            function funHeightOffset(inc_element_id){
                return document.getElementById(inc_element_id).offsetHeight / 2;
            }
			
			function funGetHalfWidth(inc_element_id){
				return document.getElementById(inc_element_id).offsetWidth / 2;
			}
			
			function funGetHalfHeight(inc_element_id){
				return document.getElementById(inc_element_id).offsetHeight / 2;
			}
			
			function funSuccess(){
				//
			}
			
			function funError(){
				//
			}
			
			function preventBehavior(e)
			{
				e.preventDefault();
			};
			
			function funBack(){
				window.location.href = "puzzle_select.html";
			}
			
			function funPieceDrag(e){
				intZIndex = intZIndex + 1;
				document.getElementById(e.target.id).style.zIndex = intZIndex;
				newX = e.layerX + document.getElementById(e.target.id).offsetLeft - funWidthOffset(e.target.id) + "px";
				newY = e.layerY + document.getElementById(e.target.id).offsetTop - funHeightOffset(e.target.id) + "px";
				document.getElementById(e.target.id).style.left = newX;
				document.getElementById(e.target.id).style.top = newY;
			}
			
			function funGetPieceNumber(inc_id){
				return parseInt(inc_id.replace(strPieceCanvasIdPrefix, ""));
			}
			
			
			
			function funPieceDrop(e){
				intPieceNumber = funGetPieceNumber(e.target.id);
				intDropContainerX = document.getElementById("div_piece_holder").offsetLeft;
				intDropContainerY = document.getElementById("div_piece_holder").offsetTop;
				intDropPieceX = intDropContainerX + (arrPieceImgAnchor[strDevice][intPieceNumber].x*-1) + 2;
				intDropPieceY = intDropContainerY + (arrPieceImgAnchor[strDevice][intPieceNumber].y*-1) + 2;
				
				intDropPieceXMax = intDropPieceX + document.getElementById(e.target.id).offsetWidth;
				intDropPieceYMax = intDropPieceY + document.getElementById(e.target.id).offsetHeight;
				
				intCorrect = 0;
				intWidthMiddle = funGetHalfWidth(e.target.id);
				intHeightMiddle = funGetHalfHeight(e.target.id);
				
				intDropCenterX = (e.layerX*-1) + intWidthMiddle;
				intDropCenterY = (e.layerY*-1) + intHeightMiddle;
				
				if((intDropCenterX > intDropPieceX) && (intDropCenterX < intDropPieceXMax)){
					if((intDropCenterY > intDropPieceY) && (intDropCenterY < intDropPieceYMax)){
						intCorrect = 1;
					}
				}
				
				if(intCorrect == 1){
					mp3Start = new Media("sounds/pop.m4a", funSuccess, funError);
					mp3Start.play();
					
					document.getElementById(e.target.id).style.left = intDropPieceX + "px";
					document.getElementById(e.target.id).style.top = intDropPieceY + "px";
					document.getElementById(e.target.id).removeEventListener('touchmove', funPieceDrag, false);
					document.getElementById(e.target.id).removeEventListener('touchend', funPieceDrop, false);
					intGameWin++;
					if(intGameWin == 9){
						document.getElementById("div_back_button").className = "div_back_button_anim";
						funHideItem("div_good_luck_text");
						funShowItem("div_great_job_text");
						funShowItem("img_large_image");
						funShowItem("div_piece_red");
						funShowItem("div_piece_green");
						funShowItem("div_piece_blue");
						funShowItem("div_piece_yellow");
						funShowItem("div_piece_purple");
						funShowItem("div_piece_orange");
						mp3Start = new Media("sounds/win.mp3", funSuccess, funError);
						mp3Start.play();
					}
				}else{
					document.getElementById(e.target.id).style.left = arrPiecePositions[strDevice][intPieceNumber].x + "px";
					document.getElementById(e.target.id).style.top = arrPiecePositions[strDevice][intPieceNumber].y + "px";
				}
			}
			
			var intPuzzleWidth = [];
			intPuzzleWidth["ipad"] = 400;
			intPuzzleWidth["iphone"] = 160;
			intPuzzleWidth["iphone5"] = 160;
			var intPuzzleHeight = [];
			intPuzzleHeight["ipad"] = 300;
			intPuzzleHeight["iphone"] = 120;
			intPuzzleHeight["iphone5"] = 120;
			var intGameWin = 0;
			
			var strPieceCanvasIdPrefix = "canvas_piece_";
			
			var arrPiecePositions = [];
			arrPiecePositions["ipad"] = [
										 {x:813,y:568},
										 {x:540,y:138},
										 {x:42,y:567},
										 {x:807,y:341},
										 {x:42,y:135},
										 {x:815,y:140},
										 {x:45,y:343},
										 {x:285,y:140},
										 {x:462,y:605}
										 ];
			arrPiecePositions["iphone"] = [
										 {x:40,y:70},
										 {x:40,y:150},
										 {x:40,y:230},
										 {x:380,y:70},
										 {x:380,y:150},
										 {x:380,y:230},
										 {x:150,y:54},
										 {x:270,y:54},
										 {x:210,y:240}
										 ];
			arrPiecePositions["iphone5"] = [
											{x:85,y:70},
											{x:85,y:150},
											{x:85,y:230},
											{x:425,y:70},
											{x:425,y:150},
											{x:425,y:230},
											{x:195,y:59},
											{x:315,y:59},
											{x:255,y:249}
										   ];
			
			var arrPieceDimensions = [];
			arrPieceDimensions["ipad"] = [
									  {x:150,y:100},
									  {x:150,y:125},
									  {x:150,y:125},
									  {x:150,y:125},
									  {x:150,y:100},
									  {x:150,y:125},
									  {x:150,y:125},
									  {x:150,y:125},
									  {x:150,y:100}
									  ];
			
			
			arrPieceDimensions["iphone"] = [
									  {x:60,y:40},
									  {x:60,y:50},
									  {x:60,y:50},
									  {x:60,y:50},
									  {x:60,y:40},
									  {x:60,y:50},
									  {x:60,y:50},
									  {x:60,y:50},
									  {x:60,y:40}
									  ];
			
			arrPieceDimensions["iphone5"] = [
											 {x:60,y:40},
											 {x:60,y:50},
											 {x:60,y:50},
											 {x:60,y:50},
											 {x:60,y:40},
											 {x:60,y:50},
											 {x:60,y:50},
											 {x:60,y:50},
											 {x:60,y:40}
									  ];
			
			
			var arrPieceStartEnd = [];
			arrPieceStartEnd["ipad"] = [
									{x:0,y:0},
									{x:25,y:0},
									{x:25,y:0},
									{x:0,y:25},
									{x:0,y:0},
									{x:0,y:25},
									{x:0,y:25},
									{x:0,y:25},
									{x:0,y:0}
									];
			
			
			arrPieceStartEnd["iphone"] = [
									{x:0,y:0},
									{x:10,y:0},
									{x:10,y:0},
									{x:0,y:10},
									{x:0,y:0},
									{x:0,y:10},
									{x:0,y:10},
									{x:0,y:10},
									{x:0,y:0}
									];
			
			arrPieceStartEnd["iphone5"] = [
										   {x:0,y:0},
										   {x:10,y:0},
										   {x:10,y:0},
										   {x:0,y:10},
										   {x:0,y:0},
										   {x:0,y:10},
										   {x:0,y:10},
										   {x:0,y:10},
										   {x:0,y:0}
									];
			
			var arrPieceImgAnchor = [];
			arrPieceImgAnchor["ipad"] = [
									 {x:0,y:0},
									 {x:-125,y:0},
									 {x:-250,y:0},
									 {x:0,y:-75},
									 {x:-125,y:-100},
									 {x:-250,y:-100},
									 {x:0,y:-175},
									 {x:-125,y:-175},
									 {x:-250,y:-200}
									 ];
			
			arrPieceImgAnchor["iphone"] = [
									 {x:0,y:0},
									 {x:-50,y:0},
									 {x:-100,y:0},
									 {x:0,y:-30},
									 {x:-50,y:-40},
									 {x:-100,y:-40},
									 {x:0,y:-70},
									 {x:-50,y:-70},
									 {x:-100,y:-80}
									 ];
			
			arrPieceImgAnchor["iphone5"] = [
											{x:0,y:0},
											{x:-50,y:0},
											{x:-100,y:0},
											{x:0,y:-30},
											{x:-50,y:-40},
											{x:-100,y:-40},
											{x:0,y:-70},
											{x:-50,y:-70},
											{x:-100,y:-80}
									 ];
			
			var arrPiecePoints = [];
			arrPiecePoints["ipad"] = [
								  //0
								  [
								   {x:150,y:0},
								   {x:150,y:25},
								   {x:125,y:25},
								   {x:125,y:75},
								   {x:150,y:75},
								   {x:150,y:100},
								   {x:100,y:100},
								   {x:100,y:75},
								   {x:50,y:75},
								   {x:50,y:100},
								   {x:0,y:100}
								   ],
								  //1
								  [
								   {x:150,y:0},
								   {x:150,y:25},
								   {x:125,y:25},
								   {x:125,y:75},
								   {x:150,y:75},
								   {x:150,y:100},
								   {x:100,y:100},
								   {x:100,y:125},
								   {x:50,y:125},
								   {x:50,y:100},
								   {x:25,y:100},
								   {x:25,y:75},
								   {x:0,y:75},
								   {x:0,y:25},
								   {x:25,y:25}
								   ],
								  //2
								  [
								   {x:150,y:0},
								   {x:150,y:100},
								   {x:100,y:100},
								   {x:100,y:125},
								   {x:50,y:125},
								   {x:50,y:100},
								   {x:25,y:100},
								   {x:25,y:75},
								   {x:0,y:75},
								   {x:0,y:25},
								   {x:25,y:25}
								   ],
								  //3
								  [
								   {x:50,y:25},
								   {x:50,y:0},
								   {x:100,y:0},
								   {x:100,y:25},
								   {x:125,y:25},
								   {x:125,y:50},
								   {x:150,y:50},
								   {x:150,y:100},
								   {x:125,y:100},
								   {x:125,y:125},
								   {x:100,y:125},
								   {x:100,y:100},
								   {x:50,y:100},
								   {x:50,y:125},
								   {x:0,y:125}
								   ],
								  //4
								  [
								   {x:50,y:0},
								   {x:50,y:25},
								   {x:100,y:25},
								   {x:100,y:0},
								   {x:150,y:0},
								   {x:150,y:25},
								   {x:125,y:25},
								   {x:125,y:75},
								   {x:150,y:75},
								   {x:150,y:100},
								   {x:100,y:100},
								   {x:100,y:75},
								   {x:50,y:75},
								   {x:50,y:100},
								   {x:0,y:100},
								   {x:0,y:75},
								   {x:25,y:75},
								   {x:25,y:25},
								   {x:0,y:25}
								   ],
								  //5
								  [
								   {x:25,y:25},
								   {x:25,y:0},
								   {x:50,y:0},
								   {x:50,y:25},
								   {x:100,y:25},
								   {x:100,y:0},
								   {x:150,y:0},
								   {x:150,y:100},
								   {x:100,y:100},
								   {x:100,y:125},
								   {x:50,y:125},
								   {x:50,y:100},
								   {x:25,y:100},
								   {x:25,y:75},
								   {x:0,y:75}
								   ],
								  //6
								  [
								   {x:50,y:25},
								   {x:50,y:0},
								   {x:100,y:0},
								   {x:100,y:25},
								   {x:125,y:25},
								   {x:125,y:50},
								   {x:150,y:50},
								   {x:150,y:100},
								   {x:125,y:100},
								   {x:125,y:125},
								   {x:0,y:125}
								   ],
								  //7
								  [
								   {x:50,y:25},
								   {x:50,y:0},
								   {x:100,y:0},
								   {x:100,y:25},
								   {x:125,y:25},
								   {x:125,y:50},
								   {x:150,y:50},
								   {x:150,y:100},
								   {x:125,y:100},
								   {x:125,y:125},
								   {x:0,y:125},
								   {x:0,y:100},
								   {x:25,y:100},
								   {x:25,y:50},
								   {x:0,y:50}
								   ],
								  //8
								  [
								   {x:50,y:0},
								   {x:50,y:25},
								   {x:100,y:25},
								   {x:100,y:0},
								   {x:150,y:0},
								   {x:150,y:100},
								   {x:0,y:100},
								   {x:0,y:75},
								   {x:25,y:75},
								   {x:25,y:25},
								   {x:0,y:25}
								   ]
								  ];
			arrPiecePoints["iphone"] = [
								  //0
								  [
								   {x:60,y:0},
								   {x:60,y:10},
								   {x:50,y:10},
								   {x:50,y:30},
								   {x:60,y:30},
								   {x:60,y:40},
								   {x:40,y:40},
								   {x:40,y:30},
								   {x:20,y:30},
								   {x:20,y:40},
								   {x:0,y:40}
								   ],
								  //1
								  [
								   {x:60,y:0},
								   {x:60,y:10},
								   {x:50,y:10},
								   {x:50,y:30},
								   {x:60,y:30},
								   {x:60,y:40},
								   {x:40,y:40},
								   {x:40,y:50},
								   {x:20,y:50},
								   {x:20,y:40},
								   {x:10,y:40},
								   {x:10,y:30},
								   {x:0,y:30},
								   {x:0,y:10},
								   {x:10,y:10}
								   ],
								  //2
								  [
								   {x:60,y:0},
								   {x:60,y:40},
								   {x:40,y:40},
								   {x:40,y:50},
								   {x:20,y:50},
								   {x:20,y:40},
								   {x:10,y:40},
								   {x:10,y:30},
								   {x:0,y:30},
								   {x:0,y:10},
								   {x:10,y:10}
								   ],
								  //3
								  [
								   {x:20,y:10},
								   {x:20,y:0},
								   {x:40,y:0},
								   {x:40,y:10},
								   {x:50,y:10},
								   {x:50,y:20},
								   {x:60,y:20},
								   {x:60,y:40},
								   {x:50,y:40},
								   {x:50,y:50},
								   {x:40,y:50},
								   {x:40,y:40},
								   {x:20,y:40},
								   {x:20,y:50},
								   {x:0,y:50}
								   ],
								  //4
								  [
								   {x:20,y:0},
								   {x:20,y:10},
								   {x:40,y:10},
								   {x:40,y:0},
								   {x:60,y:0},
								   {x:60,y:10},
								   {x:50,y:10},
								   {x:50,y:30},
								   {x:60,y:30},
								   {x:60,y:40},
								   {x:40,y:40},
								   {x:40,y:30},
								   {x:20,y:30},
								   {x:20,y:40},
								   {x:0,y:40},
								   {x:0,y:30},
								   {x:10,y:30},
								   {x:10,y:10},
								   {x:0,y:10}
								   ],
								  //5
								  [
								   {x:10,y:10},
								   {x:10,y:0},
								   {x:20,y:0},
								   {x:20,y:10},
								   {x:40,y:10},
								   {x:40,y:0},
								   {x:60,y:0},
								   {x:60,y:40},
								   {x:40,y:40},
								   {x:40,y:50},
								   {x:20,y:50},
								   {x:20,y:40},
								   {x:10,y:40},
								   {x:10,y:30},
								   {x:0,y:30}
								   ],
								  //6
								  [
								   {x:20,y:10},
								   {x:20,y:0},
								   {x:40,y:0},
								   {x:40,y:10},
								   {x:50,y:10},
								   {x:50,y:20},
								   {x:60,y:20},
								   {x:60,y:40},
								   {x:50,y:40},
								   {x:50,y:50},
								   {x:0,y:50}
								   ],
								  //7
								  [
								   {x:20,y:10},
								   {x:20,y:0},
								   {x:40,y:0},
								   {x:40,y:10},
								   {x:50,y:10},
								   {x:50,y:20},
								   {x:60,y:20},
								   {x:60,y:40},
								   {x:50,y:40},
								   {x:50,y:50},
								   {x:0,y:50},
								   {x:0,y:40},
								   {x:10,y:40},
								   {x:10,y:20},
								   {x:0,y:20}
								   ],
								  //8
								  [
								   {x:20,y:0},
								   {x:20,y:10},
								   {x:40,y:10},
								   {x:40,y:0},
								   {x:60,y:0},
								   {x:60,y:40},
								   {x:0,y:40},
								   {x:0,y:30},
								   {x:10,y:30},
								   {x:10,y:10},
								   {x:0,y:10}
								   ]
								  ];
			arrPiecePoints["iphone5"] = [
										 //0
										 [
										  {x:60,y:0},
										  {x:60,y:10},
										  {x:50,y:10},
										  {x:50,y:30},
										  {x:60,y:30},
										  {x:60,y:40},
										  {x:40,y:40},
										  {x:40,y:30},
										  {x:20,y:30},
										  {x:20,y:40},
										  {x:0,y:40}
										  ],
										 //1
										 [
										  {x:60,y:0},
										  {x:60,y:10},
										  {x:50,y:10},
										  {x:50,y:30},
										  {x:60,y:30},
										  {x:60,y:40},
										  {x:40,y:40},
										  {x:40,y:50},
										  {x:20,y:50},
										  {x:20,y:40},
										  {x:10,y:40},
										  {x:10,y:30},
										  {x:0,y:30},
										  {x:0,y:10},
										  {x:10,y:10}
										  ],
										 //2
										 [
										  {x:60,y:0},
										  {x:60,y:40},
										  {x:40,y:40},
										  {x:40,y:50},
										  {x:20,y:50},
										  {x:20,y:40},
										  {x:10,y:40},
										  {x:10,y:30},
										  {x:0,y:30},
										  {x:0,y:10},
										  {x:10,y:10}
										  ],
										 //3
										 [
										  {x:20,y:10},
										  {x:20,y:0},
										  {x:40,y:0},
										  {x:40,y:10},
										  {x:50,y:10},
										  {x:50,y:20},
										  {x:60,y:20},
										  {x:60,y:40},
										  {x:50,y:40},
										  {x:50,y:50},
										  {x:40,y:50},
										  {x:40,y:40},
										  {x:20,y:40},
										  {x:20,y:50},
										  {x:0,y:50}
										  ],
										 //4
										 [
										  {x:20,y:0},
										  {x:20,y:10},
										  {x:40,y:10},
										  {x:40,y:0},
										  {x:60,y:0},
										  {x:60,y:10},
										  {x:50,y:10},
										  {x:50,y:30},
										  {x:60,y:30},
										  {x:60,y:40},
										  {x:40,y:40},
										  {x:40,y:30},
										  {x:20,y:30},
										  {x:20,y:40},
										  {x:0,y:40},
										  {x:0,y:30},
										  {x:10,y:30},
										  {x:10,y:10},
										  {x:0,y:10}
										  ],
										 //5
										 [
										  {x:10,y:10},
										  {x:10,y:0},
										  {x:20,y:0},
										  {x:20,y:10},
										  {x:40,y:10},
										  {x:40,y:0},
										  {x:60,y:0},
										  {x:60,y:40},
										  {x:40,y:40},
										  {x:40,y:50},
										  {x:20,y:50},
										  {x:20,y:40},
										  {x:10,y:40},
										  {x:10,y:30},
										  {x:0,y:30}
										  ],
										 //6
										 [
										  {x:20,y:10},
										  {x:20,y:0},
										  {x:40,y:0},
										  {x:40,y:10},
										  {x:50,y:10},
										  {x:50,y:20},
										  {x:60,y:20},
										  {x:60,y:40},
										  {x:50,y:40},
										  {x:50,y:50},
										  {x:0,y:50}
										  ],
										 //7
										 [
										  {x:20,y:10},
										  {x:20,y:0},
										  {x:40,y:0},
										  {x:40,y:10},
										  {x:50,y:10},
										  {x:50,y:20},
										  {x:60,y:20},
										  {x:60,y:40},
										  {x:50,y:40},
										  {x:50,y:50},
										  {x:0,y:50},
										  {x:0,y:40},
										  {x:10,y:40},
										  {x:10,y:20},
										  {x:0,y:20}
										  ],
										 //8
										 [
										  {x:20,y:0},
										  {x:20,y:10},
										  {x:40,y:10},
										  {x:40,y:0},
										  {x:60,y:0},
										  {x:60,y:40},
										  {x:0,y:40},
										  {x:0,y:30},
										  {x:10,y:30},
										  {x:10,y:10},
										  {x:0,y:10}
										  ]
								  ];
			
			
			function funCreatePieces(){
				for(var intPieces=0; intPieces<arrPieceDimensions[strDevice].length; intPieces++){
					var newPieceCanvas = document.createElement('canvas');
					newPieceCanvas.setAttribute("id",strPieceCanvasIdPrefix + intPieces);
					newPieceCanvas.setAttribute("width", arrPieceDimensions[strDevice][intPieces].x);
					newPieceCanvas.setAttribute("height", arrPieceDimensions[strDevice][intPieces].y);
					document.getElementById("div_container").appendChild(newPieceCanvas);
				}
			}
			
			
			
			function funTrimPieces(){
				var thumbImg = document.createElement('img');
				thumbImg.src = strPuzzleImageSrc;
				thumbImg.onload = function() {
					for(var intPieces=0; intPieces<arrPiecePoints[strDevice].length; intPieces++){
						var canvas =  document.getElementById(strPieceCanvasIdPrefix + intPieces);
      					var ctx = canvas.getContext('2d');
      					ctx.beginPath();
      					ctx.moveTo(arrPieceStartEnd[strDevice][intPieces].x,arrPieceStartEnd[strDevice][intPieces].y);
      					for(var i=0; i<arrPiecePoints[strDevice][intPieces].length; i++){
      						ctx.lineTo(arrPiecePoints[strDevice][intPieces][i].x,arrPiecePoints[strDevice][intPieces][i].y);
      					}
      					ctx.lineTo(arrPieceStartEnd[strDevice][intPieces].x,arrPieceStartEnd[strDevice][intPieces].y);
      					ctx.closePath();
						ctx.clip();
						ctx.drawImage(thumbImg, arrPieceImgAnchor[strDevice][intPieces].x, arrPieceImgAnchor[strDevice][intPieces].y, intPuzzleWidth[strDevice], intPuzzleHeight[strDevice]);
					}
				}
			}
			
			function funPositionPieces(){
				fisherYates(arrPiecePositions[strDevice]);
				for(var intPieces=0; intPieces<arrPieceDimensions[strDevice].length; intPieces++){
					document.getElementById(strPieceCanvasIdPrefix + intPieces).style.left = arrPiecePositions[strDevice][intPieces].x + "px";
					document.getElementById(strPieceCanvasIdPrefix + intPieces).style.top = arrPiecePositions[strDevice][intPieces].y + "px";
				}
			}
			
			function funActivatePieces(){
				for(var intPieces=0; intPieces<arrPieceDimensions[strDevice].length; intPieces++){
					document.getElementById(strPieceCanvasIdPrefix + intPieces).addEventListener('touchmove', funPieceDrag, false);
					document.getElementById(strPieceCanvasIdPrefix + intPieces).addEventListener('touchend', funPieceDrop, false);
				}
			}
			function funStart(){
				funDevicePrep();
				strPuzzleNumber = getParameterByName("puzzle");
				strPuzzleImageSrc = "img/puzzles/plane" + strPuzzleNumber + ".jpg";
				document.getElementById("img_large_image").src = strPuzzleImageSrc;
				document.getElementById("div_back_button").addEventListener('touchend', function(){funBack();}, false);
				funCreatePieces();
				funTrimPieces();
				funPositionPieces();
				funActivatePieces();
			}
			
			function fisherYates ( myArray ) {
				var i = myArray.length;
				if ( i == 0 ) return false;
				while ( --i ) {
					var j = Math.floor( Math.random() * ( i + 1 ) );
					var tempi = myArray[i];
					var tempj = myArray[j];
					myArray[i] = tempj;
					myArray[j] = tempi;
				}
			}
			
			var strPuzzleNumber = "";
			
			function getParameterByName(name){
				name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
				var regexS = "[\\?&]" + name + "=([^&#]*)";
				var regex = new RegExp(regexS);
				var results = regex.exec(window.location.search);
				if(results == null){
					return "";
				}else{
					return decodeURIComponent(results[1].replace(/\+/g, " "));
				}
			}
									  
			
			
		</script>
		<style>
			
			
			
			
			
			
			
			
			
			
			
			/*
			 ALL DEVICE CSS
			 */
			body, div, img, canvas{
				margin: 0px;
				padding: 0px;
			}
			#div_container{
				background-size: 100%;
			}
			#div_container canvas{
				position:absolute;
			}
			#div_back_button{
				background: url('img/back.png');
				background-size: 100%;
				position: absolute;
			}
			.div_back_button_anim{
				-webkit-animation-name: anmBackBtn;
				-webkit-animation-duration: 1s;
				-webkit-animation-timing-function: linear;
				-webkit-animation-iteration-count: infinite;
			}
			@-webkit-keyframes anmBackBtn
            {
                0%	{-webkit-transform: scale(1.0) rotate(0deg);}
				25% {-webkit-transform: scale(1.05) rotate(-10deg);}
                50% {-webkit-transform: scale(1.1) rotate(0deg);}
				75% {-webkit-transform: scale(1.05) rotate(10deg);}
                100%{-webkit-transform: scale(1.0) rotate(0deg);}
            }
			#div_good_luck_text{
				background: url('img/good_luck_text.png');
				background-size: 100%;
				position: absolute;
			}
			#div_great_job_text{
				background: url('img/great_job_text.png');
				background-size: 100%;
				position: absolute;
				visibility:hidden;
				display:none;
			}
			#div_piece_holder{
				background: #555;
				position: absolute;
			}
			#img_large_image{
				visibility: hidden;
				display: none;
				position: absolute;
				z-index: 10000;
			}
			#div_piece_red{
				background: url('img/piece_red.png');
				background-size: 100%;
				position: absolute;
				-webkit-animation-duration: 5s;
				-webkit-animation-timing-function: linear;
				-webkit-animation-iteration-count: 1;
				visibility: hidden;
				display: none;
				z-index: 20000;
			}
			#div_piece_green{
				background: url('img/piece_green.png');
				background-size: 100%;
				position: absolute;
				-webkit-animation-duration: 7s;
				-webkit-animation-timing-function: linear;
				-webkit-animation-iteration-count: 1;
				visibility: hidden;
				display: none;
				z-index: 20000;
			}
			#div_piece_blue{
				background: url('img/piece_blue.png');
				background-size: 100%;
				position: absolute;
				-webkit-animation-duration: 3s;
				-webkit-animation-timing-function: linear;
				-webkit-animation-iteration-count: 1;
				visibility: hidden;
				display: none;
				z-index: 20000;
			}
			#div_piece_yellow{
				background: url('img/piece_yellow.png');
				background-size: 100%;
				position: absolute;
				-webkit-animation-duration: 8s;
				-webkit-animation-timing-function: linear;
				-webkit-animation-iteration-count: 1;
				visibility: hidden;
				display: none;
				z-index: 20000;
			}
			#div_piece_purple{
				background: url('img/piece_purple.png');
				background-size: 100%;
				position: absolute;
				-webkit-animation-duration: 4s;
				-webkit-animation-timing-function: linear;
				-webkit-animation-iteration-count: 1;
				visibility: hidden;
				display: none;
				z-index: 20000;
			}
			#div_piece_orange{
				background: url('img/piece_orange.png');
				background-size: 100%;
				position: absolute;
				-webkit-animation-duration: 6s;
				-webkit-animation-timing-function: linear;
				-webkit-animation-iteration-count: 1;
				visibility: hidden;
				display: none;
				z-index: 20000;
			}
			
			/*
			 iPad CSS - Begin
			 */
			.body_ipad #div_container{
				background: url('img/background_general_ipad.jpg');
				width: 1024px;
				height: 748px;
			}
			.body_ipad #div_back_button{
				width: 83px;
				height: 86px;
				top: 7px;
				left: 7px;
			}
			.body_ipad #div_good_luck_text{
				width: 304px;
				height: 59px;
				top: 20px;
				left: 353px;
			}
			.body_ipad #div_great_job_text{
				width: 275px;
				height: 67px;
				top: 18px;
				left: 368px;
			}
			.body_ipad #div_piece_holder{
				width: 400px;
				height: 300px;
				top: 284px;
				left: 312px;
				border: 2px solid #444;
			}
			.body_ipad #img_large_image{
				width: 820px;
				height: 620px;
				top: 104px;
				left: 102px;
				border: 10px solid #444;
			}
			.body_ipad #div_piece_red{
				width: 129px;
				height: 218px;
				top: -218px;
				left: 100px;
				-webkit-animation-name: anmPieceRediPad;
			}
			@-webkit-keyframes anmPieceRediPad
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,250px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,500px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,750px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,1000px)	scale(1.0) rotate(-300deg);}
			}
			.body_ipad #div_piece_green{
				width: 206px;
				height: 135px;
				top: -135px;
				left: 200px;
				-webkit-animation-name: anmPieceGreeniPad;
			}
			@-webkit-keyframes anmPieceGreeniPad
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,250px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,500px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,750px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,1000px)	scale(1.0) rotate(-300deg);}
			}
			.body_ipad #div_piece_blue{
				width: 128px;
				height: 218px;
				top: -218px;
				left: 280px;
				-webkit-animation-name: anmPieceBlueiPad;
			}
			@-webkit-keyframes anmPieceBlueiPad
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,250px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,500px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,750px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,1000px)	scale(1.0) rotate(-300deg);}
			}
			.body_ipad #div_piece_yellow{
				width: 163px;
				height: 215px;
				top: -215px;
				left: 600px;
				-webkit-animation-name: anmPieceYellowiPad;
			}
			@-webkit-keyframes anmPieceYellowiPad
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,250px)	scale(1.1) rotate(-20deg);}
				50% {-webkit-transform: translate(0px,500px)	scale(1.2) rotate(-80deg);}
				75% {-webkit-transform: translate(0px,750px)	scale(1.1) rotate(-150deg);}
				100%{-webkit-transform: translate(0px,1000px)	scale(1.0) rotate(-300deg);}
			}
			.body_ipad #div_piece_purple{
				width: 179px;
				height: 140px;
				top: -179px;
				left: 750px;
				-webkit-animation-name: anmPiecePurpleiPad;
			}
			@-webkit-keyframes anmPiecePurpleiPad
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,250px)	scale(1.1) rotate(-60deg);}
				50% {-webkit-transform: translate(0px,500px)	scale(1.2) rotate(-130deg);}
				75% {-webkit-transform: translate(0px,750px)	scale(1.1) rotate(-210deg);}
				100%{-webkit-transform: translate(0px,1000px)	scale(1.0) rotate(-300deg);}
			}
			.body_ipad #div_piece_orange{
				width: 179px;
				height: 140px;
				top: -179px;
				left: 800px;
				-webkit-animation-name: anmPieceOrangeiPad;
			}
			@-webkit-keyframes anmPieceOrangeiPad
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,250px)	scale(1.1) rotate(-100deg);}
				50% {-webkit-transform: translate(0px,500px)	scale(1.2) rotate(-180deg);}
				75% {-webkit-transform: translate(0px,750px)	scale(1.1) rotate(-270deg);}
				100%{-webkit-transform: translate(0px,1000px)	scale(1.0) rotate(-300deg);}
			}
			/*
			 iPad CSS - End
			 */
			
			/*
			 iPhone CSS - Begin
			 */
			.body_iphone #div_container{
				background: url('img/background_general_iphone.jpg');
				width: 480px;
				height: 300px;
			}
			.body_iphone #div_back_button{
				width: 40px;
				height: 40px;
				top: 3px;
				left: 3px;
			}
			.body_iphone #div_good_luck_text{
				width: 143px;
				height: 27px;
				top: 9px;
				left: 165px;
			}
			.body_iphone #div_great_job_text{
				width: 129px;
				height: 31px;
				top: 8px;
				left: 173px;
			}
			.body_iphone #div_piece_holder{
				width: 160px;
				height: 120px;
				top: 110px;
				left: 158px;
				border: 2px solid #444;
			}
			.body_iphone #img_large_image{
				width: 320px;
				height: 240px;
				top: 51px;
				left: 79px;
				border: 2px solid #444;
			}
			.body_iphone #div_piece_red{
				width: 86px;
				height: 145px;
				top: -147px;
				left: 30px;
				-webkit-animation-name: anmPieceRediPhone;
			}
			@-webkit-keyframes anmPieceRediPhone
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone #div_piece_green{
				width: 137px;
				height: 90px;
				top: -140px;
				left: 70px;
				-webkit-animation-name: anmPieceGreeniPhone;
			}
			@-webkit-keyframes anmPieceGreeniPhone
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone #div_piece_blue{
				width: 86px;
				height: 145px;
				top: -146px;
				left: 90px;
				-webkit-animation-name: anmPieceBlueiPhone;
			}
			@-webkit-keyframes anmPieceBlueiPhone
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone #div_piece_yellow{
				width: 109px;
				height: 143px;
				top: -144px;
				left: 300px;
				-webkit-animation-name: anmPieceYellowiPhone;
			}
			@-webkit-keyframes anmPieceYellowiPhone
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-20deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-80deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-150deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone #div_piece_purple{
				width: 120px;
				height: 93px;
				top: -122px;
				left: 320px;
				-webkit-animation-name: anmPiecePurpleiPhone;
			}
			@-webkit-keyframes anmPiecePurpleiPhone
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-60deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-130deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-210deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone #div_piece_orange{
				width: 120px;
				height: 93px;
				top: -121px;
				left: 340px;
				-webkit-animation-name: anmPieceOrangeiPhone;
			}
			@-webkit-keyframes anmPieceOrangeiPhone
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-100deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-180deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-270deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			/*
			 iPhone CSS - End
			 */
			
			
			
			
			/*
			 iPhone5 CSS - Begin
			 */
			.body_iphone5 #div_container{
				background: url('img/background_general_iphone5.jpg');
				width: 569px;
				height: 300px;
			}
			.body_iphone5 #div_back_button{
				width: 44px;
				height: 44px;
				top: 5px;
				left: 5px;
			}
			.body_iphone5 #div_good_luck_text{
				width: 169px;
				height: 32px;
				top: 11px;
				left: 196px;
			}
			.body_iphone5 #div_great_job_text{
				width: 153px;
				height: 37px;
				top: 10px;
				left: 205px;
			}
			.body_iphone5 #div_piece_holder{
				width: 160px;
				height: 120px;
				top: 116px;
				left: 203px;
				border: 2px solid #444;
			}
			.body_iphone5 #img_large_image{
				width: 320px;
				height: 240px;
				top: 55px;
				left: 124px;
				border: 2px solid #444;
			}
			.body_iphone5 #div_piece_red{
				width: 86px;
				height: 145px;
				top: -147px;
				left: 30px;
				-webkit-animation-name: anmPieceRediPhone5;
			}
			@-webkit-keyframes anmPieceRediPhone5
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone5 #div_piece_green{
				width: 137px;
				height: 90px;
				top: -140px;
				left: 70px;
				-webkit-animation-name: anmPieceGreeniPhone5;
			}
			@-webkit-keyframes anmPieceGreeniPhone5
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone5 #div_piece_blue{
				width: 86px;
				height: 145px;
				top: -146px;
				left: 90px;
				-webkit-animation-name: anmPieceBlueiPhone5;
			}
			@-webkit-keyframes anmPieceBlueiPhone5
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-30deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-90deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-200deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone5 #div_piece_yellow{
				width: 109px;
				height: 143px;
				top: -144px;
				left: 390px;
				-webkit-animation-name: anmPieceYellowiPhone5;
			}
			@-webkit-keyframes anmPieceYellowiPhone5
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-20deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-80deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-150deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone5 #div_piece_purple{
				width: 120px;
				height: 93px;
				top: -122px;
				left: 410px;
				-webkit-animation-name: anmPiecePurpleiPhone5;
			}
			@-webkit-keyframes anmPiecePurpleiPhone5
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-60deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-130deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-210deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			.body_iphone5 #div_piece_orange{
				width: 120px;
				height: 93px;
				top: -121px;
				left: 430px;
				-webkit-animation-name: anmPieceOrangeiPhone5;
			}
			@-webkit-keyframes anmPieceOrangeiPhone5
			{
				0%	{-webkit-transform: translate(0px,0px)		scale(1.0) rotate(0deg);}
				25% {-webkit-transform: translate(0px,110px)	scale(1.1) rotate(-100deg);}
				50% {-webkit-transform: translate(0px,220px)	scale(1.2) rotate(-180deg);}
				75% {-webkit-transform: translate(0px,330px)	scale(1.1) rotate(-270deg);}
				100%{-webkit-transform: translate(0px,450px)	scale(1.0) rotate(-300deg);}
			}
			/*
			 iPhone5 CSS - End
			 */
			
			
			
			
		</style>
    </head>
    <body id="body_all">
		<div id="div_container">
			<div id="div_back_button"></div>
			<div id="div_good_luck_text"></div>
			<div id="div_great_job_text"></div>
			<div id="div_piece_holder"></div>
		</div>
		<div id="div_piece_red"></div>
		<div id="div_piece_green"></div>
		<div id="div_piece_blue"></div>
		<div id="div_piece_yellow"></div>
		<div id="div_piece_purple"></div>
		<div id="div_piece_orange"></div>
		<img id="img_large_image" src=""/>
		<div id="div_preload"></div>
        <script type="text/javascript" src="cordova-2.2.0rc1.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript">
            app.initialize();
			</script>
    </body>
</html>
